<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Hebi Chat</title>
    <script src="https://js.pusher.com/7.2/pusher.min.js"></script>
    <style>
        body { background:#111; color:#fff; font-family:Arial; }
        #chat { width:400px; margin:40px auto; }
        #msgs { height:300px; overflow-y:auto; border:1px solid #444; padding:10px; }
        input { width:100%; padding:10px; margin-top:10px; }
    </style>
</head>
<body>
    <div id="chat">
        <h2>üí¨ Hebi Chat</h2>
        <div id="msgs"></div>
        <input id="msgInput" type="text" placeholder="Nh·∫Øn g√¨ ƒë√≥..." />
    </div>

    <script>
        // k·∫øt n·ªëi soketi/pusher
        Pusher.logToConsole = false;

        const pusher = new Pusher("app-key", {
            cluster: "mt1",
            wsHost: "chat.hebi222.top",
            wsPort: 6001,
            forceTLS: false,
            enabledTransports: ["ws"],
        });

        const channel = pusher.subscribe("chat");

        channel.bind("message", function(data) {
            const box = document.getElementById("msgs");
            box.innerHTML += `<div>üêç ${data.text}</div>`;
            box.scrollTop = box.scrollHeight;
        });

        document.getElementById("msgInput").addEventListener("keypress", function(e) {
            if (e.key === "Enter") {
                fetch("/emit", {
                    method:"POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ text: this.value })
                });
                this.value = "";
            }
        });
    </script>
</body>
</html>
