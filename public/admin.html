<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Admin - Hebi Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/style.css">
</head>
<body class="auth-body">
  <div class="auth-card">
    <div class="auth-title">
      ğŸ‘‘ Admin Panel
    </div>
    <p class="auth-sub">
      Chá»‰ Hebi dÃ¹ng: táº¡o user má»›i + mÃ£ whitelist 6 sá»‘ tá»± random.
      <br>Admin: <b>hebi</b> â€“ Pass: <b>220924</b>
    </p>

    <div>
      <div class="auth-label">Admin name</div>
      <input id="adminName" class="auth-input" placeholder="hebi" />
    </div>

    <div>
      <div class="auth-label">Admin password</div>
      <input id="adminPass" class="auth-input" placeholder="220924" />
    </div>

    <div>
      <div class="auth-label">TÃªn user má»›i</div>
      <input id="newUser" class="auth-input" placeholder="VD: soora, minhtri..." />
    </div>

    <button class="auth-btn" onclick="createUser()">
      Táº¡o user + mÃ£ whitelist
    </button>

    <p id="result" class="auth-msg"></p>

    <a href="/" class="link-small">â¬… Vá» trang login</a>
  </div>

  <script>
    async function createUser() {
      const adminName = document.getElementById("adminName").value.trim();
      const adminPass = document.getElementById("adminPass").value.trim();
      const newUser = document.getElementById("newUser").value.trim();
      const resultEl = document.getElementById("result");

      resultEl.className = "auth-msg";
      resultEl.innerText = "";

      if (!adminName || !adminPass || !newUser) {
        resultEl.classList.add("error");
        resultEl.innerText = "Nháº­p Ä‘áº§y Ä‘á»§ thÃ´ng tin.";
        return;
      }

      try {
        const res = await fetch("/admin/add-user", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ adminName, adminPass, newUsername: newUser })
        });
        const data = await res.json();

        if (!data.success) {
          resultEl.classList.add("error");
          resultEl.innerText = data.message || "Lá»—i khi táº¡o user.";
          return;
        }

        resultEl.classList.add("success");
        resultEl.innerHTML =
          `âœ” Táº¡o user <b>${data.username}</b> thÃ nh cÃ´ng.<br>MÃ£ whitelist: <b>${data.code}</b><br>Gá»­i mÃ£ nÃ y cho user Ä‘á»ƒ Ä‘Äƒng nháº­p.`;
      } catch (err) {
        resultEl.classList.add("error");
        resultEl.innerText = "Lá»—i káº¿t ná»‘i server.";
      }
    }
  </script>
</body>
</html>
